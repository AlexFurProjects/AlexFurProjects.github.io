<link rel="stylesheet" href="/assets/styles/colors.css">
<body>
    <div id="colorPicker" class="colorPickerContainer">
        <canvas class="colorWheel"></canvas>
        <div class="colorPickerSliderBox">
            <div>
                <input class="hue_slider" type="range" value=360 max=360 min=0>
                <label>H</label>
            </div>
            <div>
                <input class="saturation_slider" type="range" value=99 max=99 min=0>
                <label>S</label>
            </div>
            <div>
                <input class="value_slider" type="range" value=99 max=99 min=0>
                <label>V</label>
            </div>
                <div class="selected_color">
            </div>
            <div>
                <input class="hex_display" type="text">
            </div>
        </div>
    </div>

    <div id="palettes">
        <div class="pallete">
            <h2><button class="btn fas fa-download" onClick="download('monochromatic', 'monochromatic')"></button>Monochromatic</h2> 
            <div class="pallette_container">
                <canvas id="monochromatic" width="600" height="50"></canvas>
            </div>
        </div>
        <div>
            <h2><button class="btn fas fa-download" onClick="download('analogous', 'analogous')"></button>Analogous</h2>
            <div class="pallette_container">
                <canvas id="analogous" width="600" height="50"></canvas>
            </div>
        </div>
        <div>
            <h2><button class="btn fas fa-download" onClick="download('triadic', 'triadic')"></button>Triadic</h2>
            <div class="pallette_container">
                <canvas id="triadic" width="600" height="50"></canvas>
            </div>
        </div>
        <div>
            <h2><button class="btn fas fa-download" onClick="download('complementary', 'complementary')"></button>Complementary</h2>
            <div class="pallette_container">
                <canvas id="complementary" width="600" height="50"></canvas>
            </div>
        </div>
        <div>
            <h2><button class="btn fas fa-download" onClick="download('split', 'split_complementary')"></button>Split Complementary </h2>
            <div class="pallette_container">
                <canvas id="split" width="600" height="50"></canvas>
            </div>
        </div>
        <deiv>
            <h2><button class="btn fas fa-download" onClick="download('analogous_complementary', 'analogous_complementary')"></button>Analogous Complementary </h2>
            <div class="pallette_container">
                <canvas id="analogous_complementary" width="600" height="50"></canvas>
            </div>
        </deiv>
        <div>
            <h2><button class="btn fas fa-download" onClick="download('tetrad', 'tetrad')"></button>Tetrad</h2>
            <div class="pallette_container">
                <canvas id="tetrad" width="600" height="50"></canvas>
            </div>
        </div>
    </div>

    <script src="/assets/scripts/color.js"></script>
    <script>
         var colorWheel = new ColorWheel("colorPicker");

         var MAX_SV = 100;
         var MAX_H = 360;
         var BOX_SIZE = 50;
         var SECTOR_ANGLE = 30;
         var THIRD_ANGLE = 120;
         var OPPOSITE_ANGLE = 180;

         function download(canvasId, type) {
            var canvas = document.getElementById(canvasId);
            var link = document.createElement('a');
            link.download = "" + type + "" + colorWheel.color + ".png";
            link.href = canvas.toDataURL()
            link.click();
         }

         colorWheel.colorChange = function(color) {
            var hsvColor = RGBtoHSV(HEXtoRGB(color));
            var monoCanvas = document.getElementById("monochromatic");

            drawPalette(monoCanvas, monoChromaticPalette(hsvColor, 10, 10));

            var analogous = document.getElementById("analogous");
            drawPalette(analogous, analogousPalette(hsvColor));

            var triadic = document.getElementById("triadic");
            drawPalette(triadic, triadicPalette(hsvColor));

            var complementary = document.getElementById("complementary");
            drawPalette(complementary, complementaryPalette(hsvColor));

            var split = document.getElementById("split");
            drawPalette(split, splitComplementaryPalette(hsvColor));

            var analCompliment = document.getElementById("analogous_complementary");
            drawPalette(analCompliment, analogousComplementaryPalette(hsvColor));

            var tetrad = document.getElementById("tetrad");
            drawPalette(tetrad, tetradPalette(hsvColor));
         };

         function monoChromaticPalette(hsvColor, count, start = 0) {
            var step = (MAX_SV - start) / count;
            var colors = [];
            for (var i = start; i < (start + step * count); i = i + step) {
                var color = {h: hsvColor.h, s: hsvColor.s, v: Math.min(i, MAX_H)};
                colors.push(RGBToHex(HSVtoRGB(color)));
            }
            return colors;
         }

         function analogousPalette(hsvColor) {
            var left = _normalizeAngle(hsvColor.h - SECTOR_ANGLE);
            var right = _normalizeAngle(hsvColor.h + SECTOR_ANGLE);
            var startColors = [{h: left, s: hsvColor.s, v: hsvColor.v}, hsvColor, {h: right, s: hsvColor.s, v: hsvColor.v}];
            var colors = [];
            for (var i = 0; i < startColors.length; i++) {
                var newColors = monoChromaticPalette(startColors[i], 3, 40);
                colors = colors.concat(newColors);
            }
            return colors;
         }

         function triadicPalette(hsvColor) {
            var left = _normalizeAngle(hsvColor.h - THIRD_ANGLE);
            var right = _normalizeAngle(hsvColor.h + THIRD_ANGLE);
            var startColors = [{h: left, s: hsvColor.s, v: hsvColor.v}, hsvColor, {h: right, s: hsvColor.s, v: hsvColor.v}];
            var colors = [];
            for (var i = 0; i < startColors.length; i++) {
                var newColors = monoChromaticPalette(startColors[i], 3, 40);
                colors = colors.concat(newColors);
            }
            return colors;
         }

         function complementaryPalette(hsvColor) {
            var opposite = _normalizeAngle(hsvColor.h + OPPOSITE_ANGLE);
            var startColors = [{h: opposite, s: hsvColor.s, v: hsvColor.v}, hsvColor];
            var colors = [];
            for (var i = 0; i < startColors.length; i++) {
                var newColors = monoChromaticPalette(startColors[i], 4, 40);
                colors = colors.concat(newColors);
            }
            return colors;
         }

         function splitComplementaryPalette(hsvColor) {
            var left = _normalizeAngle(hsvColor.h + OPPOSITE_ANGLE - SECTOR_ANGLE);
            var right = _normalizeAngle(hsvColor.h + OPPOSITE_ANGLE + SECTOR_ANGLE);
            var startColors = [{h: left, s: hsvColor.s, v: hsvColor.v}, hsvColor, {h: right, s: hsvColor.s, v: hsvColor.v}];
            var colors = [];
            for (var i = 0; i < startColors.length; i++) {
                var newColors = monoChromaticPalette(startColors[i], 3, 40);
                colors = colors.concat(newColors);
            }
            return colors;
         }

         function analogousComplementaryPalette(hsvColor) {
             var colors = [];
             colors = colors.concat(monoChromaticPalette(hsvColor, 4, 30));
             var complementaryColor = {h: _normalizeAngle(hsvColor.h + OPPOSITE_ANGLE), s: hsvColor.s, v: hsvColor.v};
             colors = colors.concat(analogousPalette(complementaryColor));
             return colors;
         }

         function tetradPalette(hsvColor) {
             var angle1 = _normalizeAngle(hsvColor.h + SECTOR_ANGLE * 2);
             var angle2 = _normalizeAngle(hsvColor.h + SECTOR_ANGLE * 6);
             var angle3 = _normalizeAngle(hsvColor.h + SECTOR_ANGLE * 8);
             var color1 = { h: angle1, s: hsvColor.s, v: hsvColor.v};
             var color2 = { h: angle2, s: hsvColor.s, v: hsvColor.v};
             var color3 = { h: angle3, s: hsvColor.s, v: hsvColor.v};

             var colors = monoChromaticPalette(hsvColor, 4, 30);
             colors = colors.concat(monoChromaticPalette(color1, 4, 30));
             colors = colors.concat(monoChromaticPalette(color2, 4, 30));
             colors = colors.concat(monoChromaticPalette(color3, 4, 30));

             return colors;
         }

         function drawPalette(canvas, colors) {
            canvas.width = BOX_SIZE * colors.length;
            canvas.height = BOX_SIZE;
            var ctx = canvas.getContext("2d");
            for (var i = 0; i < colors.length; i++) {
                ctx.fillStyle = colors[i];
                ctx.fillRect(i * BOX_SIZE, 0, BOX_SIZE, BOX_SIZE);
            }
         }

        colorWheel.colorChange(colorWheel.color);
    </script>
</body>